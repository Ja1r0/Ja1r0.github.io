<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-cat.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-cat.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-cat.png?v=7.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.0.0',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Vector2 = function(x, y) { this.x = x; this.y = y; }; Vector2.prototype = {     len : function() { return Math.sqrt(this.x * this.x + this.y * this.y); },     norm : function() { return this.mul(1">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/eggs/heart.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Vector2 = function(x, y) { this.x = x; this.y = y; }; Vector2.prototype = {     len : function() { return Math.sqrt(this.x * this.x + this.y * this.y); },     norm : function() { return this.mul(1">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-02-26T14:41:12.926Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="Vector2 = function(x, y) { this.x = x; this.y = y; }; Vector2.prototype = {     len : function() { return Math.sqrt(this.x * this.x + this.y * this.y); },     norm : function() { return this.mul(1">






  <link rel="canonical" href="http://yoursite.com/eggs/heart.html"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title> | Hexo</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br/>关于</a>

  </li>

      
      
    </ul>
  

  
    

    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    

  


  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">

</h1>

<div class="post-meta">
  
  



</div>

</header>

      
      
      
      <div class="post-body">
        
        
          <!-- St. Valentine's Day 2019 programmed by Milo Yip -->
<html>
<head><meta name="generator" content="Hexo 3.8.0">
<script type="text/javascript">
Vector2 = function(x, y) { this.x = x; this.y = y; };
Vector2.prototype = {
    len : function() { return Math.sqrt(this.x * this.x + this.y * this.y); },
    norm : function() { return this.mul(1/this.len()); },
    add : function(v) { return new Vector2(this.x + v.x, this.y + v.y); },
    sub : function(v) { return new Vector2(this.x - v.x, this.y - v.y); },
    mul : function(f) { return new Vector2(this.x * f, this.y * f); },
    div : function(f) { var invf = 1/f; return new Vector2(this.x * invf, this.y * invf); },
    dot : function(v) { return this.x * v.x + this.y * v.y; },
    refl : function(n) { return this.sub(n.mul(this.dot(n)));}
};
Vector2.zero = new Vector2(0, 0);
function Particle(position, velocity, text) {
    this.position = position;
    this.velocity = velocity;
    this.text = text;
    this.acceleration = Vector2.zero;
    this.density = Vector2.zero;
    this.pressure = 0;
};
function b64EncodeUnicode(str) { return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) { return String.fromCharCode('0x' + p1); })); }
function b64DecodeUnicode(str) { return decodeURIComponent(atob(str).split('').map(function(c) {return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2); }).join('')); }
var g = new Vector2(0, 100);
var radius = 10;
var restitution = 0.5;
var text = b64DecodeUnicode(window.location.search.substr(1) || 'TUlMTw==');
var mass = 1;
var kradius = 10;
var kradius2 = kradius * kradius;
var kradius3 =  kradius2 * kradius;
var kradius5 =  kradius3 * kradius2;
var targetDensity = 0.001;
var stiffness = 50000;
var viscocity = 100;
var particles = [];
var neighborIndices = [];
function init() {
    cellSize = kradius * 2;
    gridWidth = Math.floor((canvas.width + cellSize) / cellSize);
    gridHeight = Math.floor((canvas.height + cellSize) / cellSize);
    var size = gridWidth * gridHeight;
    grid = new Array(size);
    for (var i = 0; i < size; i++)
        grid[i] = [];
}
function kernel(r) {
    if (r > kradius)
        return 0;
    else {
        var x = 1 - r * r / kradius2;
        return 315 / (64 * Math.PI * kradius3) * x * x * x;
    }
}
function kernel_gradient(r, dir) {
    if (r > kradius)
        return 0;
    else {
        var x = 1.0 - r * r / kradius2;
        return dir.mul(945 / (32 * Math.PI * kradius5) * r * x * x);
    }
}
function kernel_laplacian(r) {
    if (r > kradius)
        return 0;
    else {
        var x = r * r / kradius2;
        return 945 / (32 * Math.PI * kradius5) * (1 - x) * (3 * x - 1);
    }
}
function computeCellIndex(i) {
    var p_i = particles[i];
    var x = Math.floor(p_i.position.x / cellSize);
    var y = Math.floor(p_i.position.y / cellSize);
    return y * gridWidth + x;
}
function updateGrid() {
    for (var i = 0; i < grid.length; i++)
        grid[i].length = 0;
    for (var i = 0; i < particles.length; i++)
        grid[computeCellIndex(i)].push(i);
}
function findNeighbors(i) {
    var p_i = particles[i];
    var x1 = Math.max(Math.floor((p_i.position.x - kradius) / cellSize), 0);
    var y1 = Math.max(Math.floor((p_i.position.y - kradius) / cellSize), 0);
    var x2 = Math.min(Math.floor((p_i.position.x + kradius) / cellSize), gridWidth - 1);
    var y2 = Math.min(Math.floor((p_i.position.y + kradius) / cellSize), gridHeight - 1);
    neighborIndices.length = 0;
    for (var y = y1; y <= y2; y++)
        for (var x = x1; x <= x2; x++) {
            var cell = grid[y * gridWidth + x];
            for (var j = 0; j < cell.length; j++)
                neighborIndices.push(cell[j]);
        }
    return neighborIndices;
}
function updateDensity(i, neighbors) {
    var p_i = particles[i];
    var sum = 0;
    for (var j = 0; j < neighbors.length; j++) {
        var p_j = particles[neighbors[j]];
        var r = p_j.position.sub(p_i.position).len();
        var W = kernel(r);
        if (W > 0)
            sum += mass * W;
    }
    p_i.density = sum;
}
function updatePressure(i) {
    var p_i = particles[i];
    p_i.pressure = stiffness * (p_i.density - targetDensity);
}
function accumulatePressureForce(i, neighbors) {
    var p_i = particles[i];
    for (var j = 0; j < neighbors.length; j++) {
        var p_j = particles[neighbors[j]];
        var dir = p_j.position.sub(p_i.position);
        var r = dir.len();
        if (r > 0 && r < kradius) {
            p_i.acceleration = p_i.acceleration.sub(
                kernel_gradient(r, dir.div(r)).mul(mass * (
                    p_i.pressure / (p_i.density * p_i.density)
                  + p_j.pressure / (p_j.density * p_j.density))));
        }
    }
}
function accumulateViscocityForce(i, neighbors) {
    var p_i = particles[i];
    for (var j = 0; j < neighbors.length; j++) {
        var p_j = particles[neighbors[j]];
        var dir = p_j.position.sub(p_i.position);
        var r = dir.len();
        if (r > 0 && r < kradius) {
            p_i.acceleration = p_i.acceleration.add(
                p_j.velocity.sub(p_i.velocity).div(p_j.density)
                    .mul(viscocity * mass * kernel_laplacian(r)));
        }
    }
}
function accumulateExternalForce(i) {
    var p_i = particles[i];
    p_i.acceleration = p_i.acceleration.add(g);
}
function integration(h) {
    for (var i = 0; i < particles.length; i++) {
        var p = particles[i];
        p.velocity = p.velocity.add(p.acceleration.mul(h));
        p.position = p.position.add(p.velocity.mul(h));
        p.acceleration = Vector2.zero;
    }
}
function heart(p) {
    var q = p.sub(new Vector2(256, 256)).mul(1/150);
    var xx = q.x * q.x, yy = q.y * q.y, a = xx + yy - 1;
    return a * a * a + xx * yy * q.y;
}
function grad(f, p) {
    return new Vector2(
        (f(new Vector2(p.x + 0.01, p.y)) - f(new Vector2(p.x - 0.01, p.y))) / 0.02,
        (f(new Vector2(p.x, p.y + 0.01)) - f(new Vector2(p.x, p.y - 0.01))) / 0.02);
}
function collision() {
    for (var i = 0; i < particles.length; i++) {
        var p = particles[i];
        if (heart(p.position) > 0)
            p.velocity = p.velocity.add(grad(heart, p.position).norm().mul(-50));
        p.position.x = Math.min(Math.max(p.position.x, radius), canvas.width - radius);
        p.position.y = Math.min(Math.max(p.position.y, radius), canvas.height - radius);
    }
}
function step(h) {
    updateGrid();
    for (var i = 0; i < particles.length; i++) {
        var neighbors = findNeighbors(i);
        updateDensity(i, neighbors);
        updatePressure(i);
    }
    for (var i = 0; i < particles.length; i++) {
        var neighbors = findNeighbors(i);
        accumulatePressureForce(i, neighbors);
        accumulateViscocityForce(i, neighbors);
        accumulateExternalForce(i);
    }
    integration(h);
    collision();
}
function render() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "rgba(255, 0, 0, 0.5)";
    for (var i = 0; i < particles.length; i++) {
        var p = particles[i];
        ctx.fillText(p.text, p.position.x, p.position.y);
    }
}
function start() {
    canvas = document.getElementById("canvas1");
    ctx = canvas.getContext("2d");
    init();
    var t = 0, p = 100, c = 0;
    var loop = function() {
        step(0.01);
        render();
        setTimeout(loop, 10);
        if (particles.length < 1314 && t % Math.floor(p) == 0) {
            particles.push(new Particle(new Vector2(canvas.width / 2, canvas.height / 5), new Vector2(Math.random() * 20 - 10, 0), text.charAt(c++ % text.length)));
            p = Math.max(p * 0.98, 1);
        }
        t++;
    }
    loop();
}
</script>
</head>
<body onload="start()" style="display:grid; height: 100%">
<canvas id="canvas1" width="512" height="512" style="margin: auto; height: 100%"></canvas>
</body>
</html>
        
      </div>
      
      
      
    </div>
    



    
    
    
  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.0.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.0"></script>

  <script src="/js/src/motion.js?v=7.0.0"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.0"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.0"></script>
<script src="/js/src/post-details.js?v=7.0.0"></script>



  


  <script src="/js/src/bootstrap.js?v=7.0.0"></script>


  
  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>
